<link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@10.4.0/styles/agate.min.css">
<script src="https://unpkg.com/@highlightjs/cdn-assets@10.4.0/highlight.min.js"></script>

<style>
    .hljs {
        display: block;
        overflow-x:auto;
        padding-right: 17px;
        padding-left: 17px;
    }

    pre{
        font-family: Menlo,ui-monospace,SFMono-Regular,Monaco,Consolas,Liberation Mono,Courier New,monospace;
    }

    .hljs {
    }
</style>
<div class="py-12 bg-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="relative z-10 max-w-screen-lg xl:max-w-screen-xl mx-auto">
      <h1 class="text-4xl sm:text-6xl lg:text-4xl leading-none font-extrabold tracking-tight text-gray-900 mt-10 mb-8 sm:mt-14 sm:mb-10">
        <img class="w-8 inline-block" src="memo.svg"> <span class="transform translate-y-4 translate-x-0">memo</span>
      </h1>
      <h1 class="text-4xl sm:text-6xl lg:text-7xl leading-none font-extrabold tracking-tight text-gray-900 mt-10 mb-8 sm:mt-14 sm:mb-10">
        "a whole log simpler" ... literally
      </h1>
    </div>
    <br><br>

    <div class="mt-10">
      <dl class="space-y-10 md:space-y-0 md:grid md:grid-cols-2 md:gap-x-8 md:gap-y-10">
        <div class="flex">
          <div class="ml-4">
            <br>
            <p class="leading-6 font-medium text-gray-900 text-2xl">
              What problem are we trying to fix here?
            </p>
            <br>
            <p class="mt-2 text-base text-gray-500 text-xl">
              Let's say you're running a simulation, or maybe a machine learning experiment. Then
              you might have code that looks like the thing on the right.
            </p>
          </div>
        </div>

        <div class="flex">
          <div class="ml-4">
            <pre class="flex min-h-full text-xs md:text-sm text-lg">
              <code class="rounded px-12">
import numpy as np

def birthday_experiment(class_size, n_sim=10_000):
    """Simulates the birthday paradox. Vectorized = Fast!"""
    shape     = (n_sim, class_size)
    sims      = np.random.randint(1, 365 + 1, shape)
    sort_sims = np.sort(sims, axis=1)
    unequal   = (sort_sims[:, 1:] != sort_sims[:, :-1])
    diff      = unequal.sum(axis = 1) + 1
    return np.mean(unequal != class_size)

results = [birthday_experiment(s) for s in range(2, 40)]
              </code>
            </pre>
          </div>
        </div>
      </dl>
    </div>
    <div class="mt-10">
      <dl class="space-y-10 md:space-y-0 md:grid md:grid-cols-2 md:gap-x-8 md:gap-y-10">
        <div class="flex">
          <div class="ml-4">
            <br>
            <br>
            <p class="mt-2 text-base text-gray-500 text-lg">
              This example sort of works, but how would we now go about plotting our results? If you want
              to plot the effect of <code>class_size</code> and the simulated probability then it'd be do-able. But things
              get tricky if you're also interested in seeing the effect of `n_sim` as well. The input of the
              simulation isn't nicely captured together with the output of the simulation.
            </p>
          </div>
        </div>

        <div class="flex">
          <div class="ml-4">
            <pre class="flex min-h-full text-xs md:text-sm">
              <style>
                code{
                  Menlo,ui-monospace,SFMono-Regular,Monaco,Consolas,Liberation Mono,Courier New,monospace
                }
              </style>
              <code>
import numpy as np

def birthday_experiment(class_size, n_sim=10_000):
    """Simulates the birthday paradox. Vectorized = Fast!"""
    shape     = (n_sim, class_size)
    sims      = np.random.randint(1, 365 + 1, shape)
    sort_sims = np.sort(sims, axis=1)
    unequal   = (sort_sims[:, 1:] != sort_sims[:, :-1])
    diff      = unequal.sum(axis = 1) + 1
    return np.mean(unequal != class_size)

results = [birthday_experiment(s) for s in range(2, 40)]
              </code>
            </pre>
          </div>
        </div>
      </dl>
    </div>
  </div>
</div>


<script>
  document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre code').forEach((block) => {
      hljs.highlightBlock(block);
    });
  });
</script>